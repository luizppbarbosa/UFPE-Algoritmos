import time


def leftindex (i):
    return 2*i

def rightindex(i):
    return 2*i + 1

def maxheapify (lista, i, tamanho):
    l = leftindex(i)
    r = rightindex(i)

    if l <= tamanho and lista[l] > lista[i]:
        maior = l
    else:
        maior = i

    if r <= tamanho and lista[r] > lista[maior]:
        maior = r

    if maior != i:
        pos1 = lista[i]
        pos2 = lista[maior]
        lista[i] = pos2
        lista[maior] = pos1

        maxheapify(lista, maior, tamanho)

def criamaxheap (lista,tamanho):
    for i in range(tamanho//2, 0, -1):
        maxheapify(lista, i, tamanho)

def heapsort(lista, tamanho):
    criamaxheap(lista, tamanho)
    for i in range (tamanho, 1, -1):
        pos1 = lista[i]
        pos2 = lista[1]
        lista[i] = pos2
        lista[1] = pos1
        tamanho -= 1
        maxheapify(lista, 1, tamanho)

        




lista1 =  [5, 15, 39, 83, 153, 255, 395, 579, 813, 1103, 1455, 1875, 2369, 2943, 3603, 4355, 5205, 6159, 7223, 8403, 9705, 11135, 12699, 14403, 16253, 18255, 20415, 22739, 25233, 27903, 30755, 33795, 37029, 40463, 44103, 47955, 52025, 56319, 60843, 65603, 70605, 75855, 81359, 87123, 93153, 99455, 106035, 112899, 120053, 127503, 135255, 143315, 151689, 160383, 169403, 178755, 188445, 198479, 208863, 219603, 230705, 242175, 254019, 266243, 278853, 291855, 305255, 319059, 333273, 347903, 362955, 378435, 394349, 410703, 427503, 444755, 462465, 480639, 499283, 518403, 538005, 558095, 578679, 599763, 621353, 643455, 666075, 689219, 712893, 737103, 761855, 787155, 813009, 839423, 866403, 893955, 922085, 950799, 980103]
lista1 = [None] + lista1
tamanho1 = len(lista1) - 1

lista2 = [22, 6, -6, -2, 30, 102, 226, 414, 678, 1030, 1482, 2046, 2734, 3558, 4530, 5662, 6966, 8454, 10138, 12030, 14142, 16486, 19074, 21918, 25030, 28422, 32106, 36094, 40398, 45030, 50002, 55326, 61014, 67078, 73530, 80382, 87646, 95334, 103458, 112030, 121062, 130566, 140554, 151038, 162030, 173542, 185586, 198174, 211318, 225030, 239322, 254206, 269694, 285798, 302530, 319902, 337926, 356614, 375978, 396030, 416782, 438246, 460434, 483358, 507030, 531462, 556666, 582654, 609438, 637030, 665442, 694686, 724774, 755718, 787530, 820222, 853806, 888294, 923698, 960030, 997302, 1035526, 1074714, 1114878, 1156030, 1198182, 1241346, 1285534, 1330758, 1377030, 1424362, 1472766, 1522254, 1572838, 1624530, 1677342, 1731286, 1786374, 1842618]
lista2 = [None] + lista2
tamanho2 = len(lista2) - 1

lista3 = [-68, -354, -816, -1442, -2220, -3138, -4184, -5346, -6612, -7970, -9408, -10914, -12476, -14082, -15720, -17378, -19044, -20706, -22352, -23970, -25548, -27074, -28536, -29922, -31220, -32418, -33504, -34466, -35292, -35970, -36488, -36834, -36996, -36962, -36720, -36258, -35564, -34626, -33432, -31970, -30228, -28194, -25856, -23202, -20220, -16898, -13224, -9186, -4772, 30, 5232, 10846, 16884, 23358, 30280, 37662, 45516, 53854, 62688, 72030, 81892, 92286, 103224, 114718, 126780, 139422, 152656, 166494, 180948, 196030, 211752, 228126, 245164, 262878, 281280, 300382, 320196, 340734, 362008, 384030, 406812, 430366, 454704, 479838, 505780, 532542, 560136, 588574, 617868, 648030, 679072, 711006, 743844, 777598, 812280, 847902, 884476, 922014, 960528]
lista3 = [None] + lista3
tamanho3 = len(lista3) - 1


inicio1 = time.time()
heapsort (lista1, tamanho1)
fim1 = time.time()

print(lista1[1:])
print(fim1 - inicio1,'\n')

inicio2 = time.time()
heapsort (lista2, tamanho2)
fim2 = time.time()

print(lista2[1:])
print(fim2 - inicio2,'\n')

inicio3 = time.time()
heapsort (lista3, tamanho3)
fim3 = time.time()

print(lista3[1:])
print(fim3 - inicio3,'\n')